#+title: Doom Emacs Config
#+property: header-args:emacs-lisp :tangle config.el :comments no :lexical t

My Doom Emacs `config.el` file.

* File header
The standard Doom file header plus lexical binding.

#+begin_src emacs-lisp
;;; $DOOMDIR/config.el -*- lexical-binding: t; -*-
#+end_src

* Identity (optional)
Doom can use these for templates, email clients, and GPG. Set them if needed.

#+begin_src emacs-lisp
;; (setq user-full-name "John Doe"
;;       user-mail-address "john@doe.com")
#+end_src

* Fonts
Set the font family and size.

#+begin_src emacs-lisp
(setq doom-font (font-spec :family "Mononoki Nerd Font Mono" :size 21))
#+end_src

* Theme and UI defaults
Theme and line-number style.

#+begin_src emacs-lisp
(setq doom-theme 'catppuccin)
(setq display-line-numbers-type 'relative)
#+end_src

* Org directory
Org needs this before it loads.

#+begin_src emacs-lisp
(setq org-directory "~/Documents/org/")
#+end_src

* Org-roam
Notes database and keybindings.

#+begin_src emacs-lisp
(use-package! org-roam
  :ensure t
  :custom
  (org-roam-directory (file-truename "~/Documents/org"))
  :bind (("C-c n l" . org-roam-buffer-toggle)
         ("C-c n f" . org-roam-node-find)
         ("C-c n g" . org-roam-graph)
         ("C-c n i" . org-roam-node-insert)
         ("C-c n c" . org-roam-capture))
  :config
  (org-roam-db-autosync-mode))
#+end_src

* Org face sizes
Slightly larger headings for readability.

#+begin_src emacs-lisp
(custom-set-faces
 '(org-level-1 ((t (:height 1.3))))
 '(org-level-2 ((t (:height 1.2))))
 '(org-level-3 ((t (:height 1.1))))
 )
#+end_src

* Org mode configuration
LaTeX rendering, capture templates, weekly review, and keybindings.

#+begin_src emacs-lisp
(use-package! org
  :config
  ;; Configure LaTeX support and rendering
  (setq org-format-latex-options (plist-put org-format-latex-options :scale 2.2))
  (add-hook 'org-mode-hook #'turn-on-org-cdlatex)
  (setq org-startup-with-latex-preview t)
  (setq org-cite-global-bibliography `("~/Documents/master_references.bib"))

  ;; Org capture templates
  (setq org-capture-templates
        '(("t" "Todo" entry (file+headline "~/Documents/org/todo.org" "Tasks")
           "* TODO %?")
          ("n" "Note" entry (file+headline "~/Documents/org/notes.org" "Notes")
           "* %U %?")))

  ;; Create a weekly review
  (setq org-log-done 'time)
  (setq org-agenda-start-with-log-mode t)

  (setq org-agenda-custom-commands
        '(("w" "Weekly Review"
           ((agenda ""
                    ((org-agenda-overriding-header "Completed Tasks")
                     (org-agenda-skip-function '(org-agenda-skip-entry-if 'nottodo 'done))
                     (org-agenda-span 'week)))

            (agenda ""
                    ((org-agenda-overriding-header "Unfinished Scheduled Tasks")
                     (org-agenda-skip-function '(org-agenda-skip-entry-if 'todo 'done))
                     (org-agenda-span 'week)))))))

  ;; Keymaps
  (map! :map org-mode-map
        :leader
        :desc "Org schedule" "o s" #'org-schedule)
  (map! :map org-mode-map
        :desc "Insert citation" "C-<return>" #'org-cite-insert)
  )
#+end_src

* Org keybindings after load
Evil line navigation for visual lines.

#+begin_src emacs-lisp
(after! org
  (map! :map org-mode-map
        :n "j" #'evil-next-visual-line
        :n "k" #'evil-previous-visual-line))
#+end_src

* Capture shortcut
Global capture binding.

#+begin_src emacs-lisp
(global-set-key (kbd "C-c c") #'org-capture)
#+end_src

* Writing mode
Olivetti for text buffers and disable line numbers globally.

#+begin_src emacs-lisp
(setq olivetti-body-width 80)
(add-hook 'text-mode-hook 'olivetti-mode)
(setopt display-line-numbers-type nil)
#+end_src
